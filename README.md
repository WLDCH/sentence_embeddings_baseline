# Smooth Inverse Frequency Weighting for Sentence Embeddings
## CHRIMNI Walid

Explanation and implementation of the paper : [A single but tought-to-beat base line for sentence embeddings](https://openreview.net/pdf?id=SyK00v5xx)

My report is available in this repo.

## A Classification Performance Experiment

In this notebook, I will implement the sentence embedding with Smooth Inverse Frequency (SIF) that is used in the paper and I will compare it to two other sentence embedding : an unweighted sum of word embeddings and a BERT embedding using transformers. Note that I only implement the SIF weighting and not the component removal.

I will then compare those three embeddings using a very simple model for sentiment analysis task on the IMBD dataset.

#### Loading the NLTK Movie Reviews Dataset


```python
!pip install gensim==4.1.2
```

    Collecting gensim==4.1.2
      Downloading gensim-4.1.2-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (24.1 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24.1 MB 2.5 kB/s 
    [?25hRequirement already satisfied: numpy>=1.17.0 in /usr/local/lib/python3.7/dist-packages (from gensim==4.1.2) (1.19.5)
    Requirement already satisfied: smart-open>=1.8.1 in /usr/local/lib/python3.7/dist-packages (from gensim==4.1.2) (5.2.1)
    Requirement already satisfied: scipy>=0.18.1 in /usr/local/lib/python3.7/dist-packages (from gensim==4.1.2) (1.4.1)
    Installing collected packages: gensim
      Attempting uninstall: gensim
        Found existing installation: gensim 3.6.0
        Uninstalling gensim-3.6.0:
          Successfully uninstalled gensim-3.6.0
    Successfully installed gensim-4.1.2



```python
import nltk
from nltk.corpus import movie_reviews
import random
```


```python
import nltk
nltk.download('movie_reviews')
nltk.download('punkt')
nltk.download('stopwords')

```

    [nltk_data] Downloading package movie_reviews to /root/nltk_data...
    [nltk_data]   Unzipping corpora/movie_reviews.zip.
    [nltk_data] Downloading package punkt to /root/nltk_data...
    [nltk_data]   Unzipping tokenizers/punkt.zip.
    [nltk_data] Downloading package stopwords to /root/nltk_data...
    [nltk_data]   Unzipping corpora/stopwords.zip.





    True




```python
sentences = [(movie_reviews.sents(fileid)[0],category)
            for category in movie_reviews.categories()
            for fileid in movie_reviews.fileids(category)]

corpus_size = len(movie_reviews.words())
corpus_size
```




    1583820



The Movie Reviews dataset contains a total of `1583820` words. Due to computing limitations and by virtue of the fact that around 1.5 million words allows to take into acount a decent scope of the language used in this context, we will directly use the corpus derived from the dataset to compute the SIF weights.

Let $s(w)$ be the SIF weight for the word $w$ given by the expression 
$s(w) = \frac{a}{a+p(w)}$ where $a$ is a smoothing hyperparameter.
(Following the Paper A SIMPLE BUT TOUGH-TO-BEAT BASELINE FOR SENTENCE EMBEDDINGS by Arora et al.)


```python
a_hp = 1e-3 # default good value for the hyperparamater as adviced in the paper
```

### Computing $p(w)$ for each word contained in the Movie Reviews Corpus


```python
corpus_word_freq = nltk.FreqDist(word.lower() for word in movie_reviews.words())
```


```python
corpus_word_freq = {k:v/corpus_size for (k,v) in corpus_word_freq.items()}
```


```python
corpus_word_freq
```




    {'plot': 0.0009552853228270889,
     ':': 0.0019206728037276964,
     'two': 0.0012065765049058606,
     'teen': 9.533911681883042e-05,
     'couples': 1.7047391749062393e-05,
     'go': 0.0007027313709891276,
     'to': 0.02016453889962243,
     'a': 0.024059552221843392,
     'church': 4.356555669204834e-05,
     'party': 0.00011554343296586733,
     ',': 0.049069338687477114,
     'drink': 2.020431614703691e-05,
     'and': 0.022462148476468286,
     'then': 0.0008990920685431425,
     'drive': 6.629541235746487e-05,
     '.': 0.041593110328193864,
     'they': 0.003046432044045409,
     'get': 0.0012305691303304668,
     'into': 0.0016561225391774318,
     'an': 0.0036266747483931256,
     'accident': 6.566402747786996e-05,
     'one': 0.003694864315389375,
     'of': 0.02154474624641689,
     'the': 0.048319253450518365,
     'guys': 0.00016921114773143413,
     'dies': 6.566402747786996e-05,
     'but': 0.005451377050422397,
     'his': 0.006053086840676339,
     'girlfriend': 0.00013764190375168894,
     'continues': 5.55618694043515e-05,
     'see': 0.0011042921544114862,
     'him': 0.0016624363879733808,
     'in': 0.013778080842519984,
     'her': 0.0028551224255281534,
     'life': 0.001001376419037517,
     'has': 0.0029795052468083493,
     'nightmares': 1.641600686946749e-05,
     'what': 0.0020974605700142695,
     "'": 0.019310906542410123,
     's': 0.011688828275940448,
     'deal': 0.00013827328863128387,
     '?': 0.002380952380952381,
     'watch': 0.0003807250823957268,
     'movie': 0.003643722140142188,
     '"': 0.01111995049942544,
     'sorta': 6.313848795949035e-06,
     'find': 0.0004937429758432145,
     'out': 0.002296346807086664,
     'critique': 3.851447765528911e-05,
     'mind': 0.00028475458069730146,
     '-': 0.00984644719728252,
     'fuck': 1.073354295311336e-05,
     'for': 0.006289224785644833,
     'generation': 6.061294844111073e-05,
     'that': 0.010054172822669242,
     'touches': 3.472616837771969e-05,
     'on': 0.004662777335808362,
     'very': 0.001176270030685305,
     'cool': 0.0001313280549557399,
     'idea': 0.00024371456352363272,
     'presents': 4.924802060840247e-05,
     'it': 0.01016971625563511,
     'bad': 0.0008807819070348903,
     'package': 1.8941546387847104e-05,
     'which': 0.0019958076043994897,
     'is': 0.015907742041393592,
     'makes': 0.0006263338005581443,
     'this': 0.006047404376759985,
     'review': 0.0001862585394804965,
     'even': 0.0016195022161609274,
     'harder': 2.0835701026631814e-05,
     'write': 7.513480067179352e-05,
     'since': 0.00048490358752888586,
     'i': 0.005612380194719097,
     'generally': 6.503264259827506e-05,
     'applaud': 6.313848795949035e-06,
     'films': 0.0009698071750577717,
     'attempt': 0.00016605422333345962,
     'break': 0.0001104923539291081,
     'mold': 8.839388314328649e-06,
     'mess': 0.00010039019585558965,
     'with': 0.006813905620588198,
     'your': 0.0005417282266924272,
     'head': 0.0002443459484032276,
     'such': 0.0007696581682261873,
     '(': 0.007364473235594954,
     'lost': 0.00025823641575431554,
     'highway': 1.7678776628657298e-05,
     '&': 0.0001849957697213067,
     'memento': 6.313848795949035e-06,
     ')': 0.007438345266507558,
     'there': 0.002380320996072786,
     'are': 0.004387493528304984,
     'good': 0.0015222689447033123,
     'ways': 0.00011933174224343676,
     'making': 0.0003800936975161319,
     'all': 0.002761046078468513,
     'types': 3.0306474220555366e-05,
     'these': 0.0008264828073897287,
     'folks': 4.672248109002286e-05,
     'just': 0.0018341730752231946,
     'didn': 0.0003655718452854491,
     't': 0.004047177078203331,
     'snag': 1.2627697591898068e-06,
     'correctly': 1.073354295311336e-05,
     'seem': 0.0003624149208874746,
     'have': 0.0030944172948946217,
     'taken': 0.00014206159790885328,
     'pretty': 0.000333371216426109,
     'neat': 2.020431614703691e-05,
     'concept': 7.1977876273819e-05,
     'executed': 2.904370446136556e-05,
     'terribly': 3.66203230165044e-05,
     'so': 0.0023253905115480293,
     'problems': 0.0001849957697213067,
     'well': 0.001203419580507886,
     'its': 0.001433243676680431,
     'main': 0.0002519225669583665,
     'problem': 0.00025002841231958176,
     'simply': 0.0002702327284666187,
     'too': 0.0009956939551211627,
     'jumbled': 7.5766185551388415e-06,
     'starts': 0.0001995176219519895,
     'off': 0.0009982194946395423,
     'normal': 7.008372163503428e-05,
     'downshifts': 1.2627697591898068e-06,
     'fantasy': 6.124433332070563e-05,
     'world': 0.0006547461201399149,
     'you': 0.003356442019926507,
     'as': 0.007183897160030811,
     'audience': 0.0005770857799497418,
     'member': 7.955449482895784e-05,
     'no': 0.0015607834223586013,
     'going': 0.0005606697730802742,
     'dreams': 8.271141922693236e-05,
     'characters': 0.0011737444911669255,
     'coming': 0.00017363084188859844,
     'back': 0.0006692679723705976,
     'from': 0.0031562930130949224,
     'dead': 0.00026391887967066967,
     'others': 0.0001818388453233322,
     'who': 0.0035938427346541907,
     'look': 0.0005272063744617444,
     'like': 0.0023298102057051936,
     'strange': 0.00011680620272505714,
     'apparitions': 3.1569243979745174e-06,
     'disappearances': 1.8941546387847104e-06,
     'looooot': 6.313848795949034e-07,
     'chase': 0.00010039019585558965,
     'scenes': 0.000804384336603907,
     'tons': 1.3259082471492973e-05,
     'weird': 6.313848795949035e-05,
     'things': 0.0005379399174148577,
     'happen': 0.00013890467351087877,
     'most': 0.0014559735323458475,
     'not': 0.0035212334735007767,
     'explained': 4.419694157164324e-05,
     'now': 0.0006263338005581443,
     'personally': 2.778093470217575e-05,
     'don': 0.000817012034195805,
     'trying': 0.00035736384185071536,
     'unravel': 5.682463916354131e-06,
     'film': 0.006008889899104696,
     'every': 0.0005979214809763736,
     'when': 0.0020570519377201956,
     'does': 0.0009900114912048087,
     'give': 0.0003542069174527408,
     'me': 0.0008927782197471935,
     'same': 0.000549304845247566,
     'clue': 2.8412319581770656e-05,
     'over': 0.0009129825358942304,
     'again': 0.00043944387619805283,
     'kind': 0.000352944147693551,
     'fed': 1.83101615082522e-05,
     'up': 0.0021498655150206463,
     'after': 0.0011125001578462198,
     'while': 0.0009717013296965565,
     'biggest': 9.407634705964061e-05,
     'obviously': 0.000143955752547638,
     'got': 0.00029675089340960463,
     'big': 0.0006717935118889772,
     'secret': 0.00011617481784546224,
     'hide': 2.525539518379614e-05,
     'seems': 0.0006522205806215352,
     'want': 0.0003535755325731459,
     'completely': 0.00027780934702175753,
     'until': 0.0002721268831054034,
     'final': 0.0002399262542460633,
     'five': 0.00017931330580495258,
     'minutes': 0.0004066118624591178,
     'do': 0.0012091020444242402,
     'make': 0.0010367339722948314,
     'entertaining': 0.00019825485219279967,
     'thrilling': 2.904370446136556e-05,
     'or': 0.0019875996009647563,
     'engaging': 4.9879405487997374e-05,
     'meantime': 1.1996312712303165e-05,
     'really': 0.0009836976424088596,
     'sad': 6.818956699624957e-05,
     'part': 0.00045080880403076105,
     'arrow': 1.83101615082522e-05,
     'both': 0.0005638266974782488,
     'dig': 1.1996312712303165e-05,
     'flicks': 5.1142175247187183e-05,
     'we': 0.001752093040875857,
     'actually': 0.0005284691442209342,
     'figured': 1.83101615082522e-05,
     'by': 0.003953100731143691,
     'half': 0.00033779091058327336,
     'way': 0.0010689346011541715,
     'point': 0.00043249864252250885,
     'strangeness': 3.7883092775694207e-06,
     'did': 0.00048174666313091137,
     'start': 0.00019699208243360988,
     'little': 0.0009477087042719501,
     'bit': 0.00035862661160990516,
     'sense': 0.00035041860817517143,
     'still': 0.0006610599689358639,
     'more': 0.002113245192004142,
     'guess': 0.00014269298278844818,
     'bottom': 5.8718793802326025e-05,
     'line': 0.000274652422623783,
     'movies': 0.0007614501647914536,
     'should': 0.0005505676150067558,
     'always': 0.0003699915394426134,
     'sure': 0.00033021429202813454,
     'before': 0.0006263338005581443,
     'given': 0.0003169552095566415,
     'password': 2.5255395183796137e-06,
     'enter': 4.293417181245344e-05,
     'understanding': 3.59889381369095e-05,
     'mean': 0.00015279514086196663,
     'showing': 9.28135773004508e-05,
     'melissa': 7.5766185551388415e-06,
     'sagemiller': 5.051079036759227e-06,
     'running': 0.0002039373161091538,
     'away': 0.00041355709613466175,
     'visions': 1.957293126744201e-05,
     'about': 0.0022243689308128448,
     '20': 6.187571820030054e-05,
     'throughout': 0.00019067823363766085,
     'plain': 5.177356012678208e-05,
     'lazy': 2.146708590622672e-05,
     '!': 0.0010815622987460697,
     'okay': 7.892310994936293e-05,
     'people': 0.0009186649998105845,
     'chasing': 2.714954982258085e-05,
     'know': 0.0007683953984669975,
     'need': 0.0001995176219519895,
     'how': 0.0009578108623454686,
     'giving': 0.00013511636423330935,
     'us': 0.0006774759758053314,
     'different': 0.0002714954982258085,
     'offering': 2.399262542460633e-05,
     'further': 8.460557386571707e-05,
     'insight': 3.409478349812479e-05,
     'down': 0.0005998156356151583,
     'apparently': 0.00013195943983533484,
     'studio': 0.00010291573537396926,
     'took': 0.00010354712025356416,
     'director': 0.0007810230960588956,
     'chopped': 3.1569243979745174e-06,
     'themselves': 0.00017868192092535768,
     'shows': 0.00025886780063391043,
     'might': 0.0004009293985427637,
     've': 0.0005278377593413393,
     'been': 0.0012943390031695521,
     'decent': 0.00010354712025356416,
     'here': 0.0007500852369587453,
     'somewhere': 8.018587970855274e-05,
     'suits': 2.8412319581770656e-05,
     'decided': 6.566402747786996e-05,
     'turning': 5.051079036759228e-05,
     'music': 0.00030306474220555366,
     'video': 0.0002033059312295589,
     'edge': 6.566402747786996e-05,
     'would': 0.0013315907110656514,
     'actors': 0.00044575772499400187,
     'although': 0.0005019509792779483,
     'wes': 3.1569243979745175e-05,
     'bentley': 5.682463916354131e-06,
     'seemed': 0.00013385359447411953,
     'be': 0.003898170246618934,
     'playing': 0.00022856132641335504,
     'exact': 4.040863229407382e-05,
     'character': 0.001275397456781705,
     'he': 0.0055965955727292245,
     'american': 0.000352944147693551,
     'beauty': 8.523695874531196e-05,
     'only': 0.0015753052745892842,
     'new': 0.0008157492644366152,
     'neighborhood': 1.3259082471492973e-05,
     'my': 0.0008801505221552955,
     'kudos': 1.3259082471492973e-05,
     'holds': 5.682463916354131e-05,
     'own': 0.0005145786768698463,
     'entire': 0.00025760503087472064,
     'feeling': 0.00014206159790885328,
     'unraveling': 1.2627697591898068e-06,
     'overall': 0.00010102158073518456,
     'doesn': 0.0008062784912426917,
     'stick': 4.356555669204834e-05,
     'because': 0.0010632521372378175,
     'entertain': 3.346339861852988e-05,
     'confusing': 5.935017868192092e-05,
     'rarely': 6.440125771868016e-05,
     'excites': 1.2627697591898068e-06,
     'feels': 0.00013637913399249915,
     'redundant': 8.839388314328649e-06,
     'runtime': 5.051079036759227e-06,
     'despite': 0.000222247477617406,
     'ending': 0.00026707580406864416,
     'explanation': 4.356555669204834e-05,
     'craziness': 2.5255395183796137e-06,
     'came': 0.00011680620272505714,
     'oh': 0.00013637913399249915,
     'horror': 0.0002986450480483893,
     'slasher': 5.303632988597189e-05,
     'flick': 0.00012375143640060108,
     'packaged': 1.8941546387847104e-06,
     'someone': 0.0002531853367175563,
     'assuming': 9.470773193923552e-06,
     'genre': 0.00016921114773143413,
     'hot': 8.018587970855274e-05,
     'kids': 0.00020709424050712833,
     'also': 0.001241934058163175,
     'wrapped': 2.4624010304201235e-05,
     'production': 0.00018941546387847105,
     'years': 0.0005341516081372883,
     'ago': 0.00012564559103938578,
     'sitting': 5.8718793802326025e-05,
     'shelves': 8.208003434733744e-06,
     'ever': 0.000489954666565645,
     'whatever': 8.586834362490687e-05,
     'skip': 2.8412319581770656e-05,
     'where': 0.000942026240355596,
     'joblo': 1.8941546387847104e-05,
     'nightmare': 3.788309277569421e-05,
     'elm': 8.839388314328649e-06,
     'street': 8.839388314328648e-05,
     '3': 0.00014016744327006856,
     '7': 7.26092611534139e-05,
     '/': 0.0006061294844111073,
     '10': 0.00028349181093811167,
     'blair': 6.187571820030054e-05,
     'witch': 6.818956699624957e-05,
     '2': 0.00027717796214216263,
     'crow': 3.472616837771969e-05,
     '9': 4.735386596961776e-05,
     'salvation': 8.839388314328649e-06,
     '4': 0.00011996312712303165,
     'stir': 1.7047391749062393e-05,
     'echoes': 1.957293126744201e-05,
     '8': 8.839388314328648e-05,
     'happy': 0.00013574774911290425,
     'bastard': 2.904370446136556e-05,
     'quick': 8.776249826369158e-05,
     'damn': 5.55618694043515e-05,
     'y2k': 2.5255395183796137e-06,
     'bug': 5.1142175247187183e-05,
     'starring': 0.00011617481784546224,
     'jamie': 2.6518164942985945e-05,
     'lee': 0.0001679483779722443,
     'curtis': 2.336124054501143e-05,
     'another': 0.0007077824500258868,
     'baldwin': 5.619325428394641e-05,
     'brother': 0.00016921114773143413,
     'william': 0.00013006528519655011,
     'time': 0.0015222689447033123,
     'story': 0.0013694738038413457,
     'regarding': 1.957293126744201e-05,
     'crew': 0.00013511636423330935,
     'tugboat': 1.2627697591898068e-06,
     'comes': 0.0004628051167430642,
     'across': 0.00013953605839047366,
     'deserted': 1.3259082471492973e-05,
     'russian': 4.293417181245344e-05,
     'tech': 1.83101615082522e-05,
     'ship': 0.0001666856082130545,
     'kick': 3.283201373893498e-05,
     'power': 0.00015026960134358703,
     'within': 0.00014332436766804308,
     'gore': 6.945233675543938e-05,
     'bringing': 5.1142175247187183e-05,
     'few': 0.0006086550239294869,
     'action': 0.0007399830788852268,
     'sequences': 0.0001849957697213067,
     'virus': 4.8616635728807565e-05,
     'empty': 4.230278693285853e-05,
     'flash': 3.914586253488402e-05,
     'substance': 4.6091096210427954e-05,
     'why': 0.0005581442335618947,
     'was': 0.003119041305198823,
     'middle': 0.00014016744327006856,
     'nowhere': 6.187571820030054e-05,
     'origin': 5.051079036759227e-06,
     'pink': 1.5153237110277683e-05,
     'flashy': 2.588678006339104e-05,
     'thing': 0.0005107903675922769,
     'hit': 0.00017994469068454748,
     'mir': 4.4196941571643245e-06,
     'course': 0.00040913740197749747,
     'donald': 2.399262542460633e-05,
     'sutherland': 2.4624010304201235e-05,
     'stumbling': 9.470773193923552e-06,
     'around': 0.0005701405462741979,
     'drunkenly': 1.2627697591898068e-06,
     'hey': 4.419694157164324e-05,
     'let': 0.00026833857382783395,
     'some': 0.0018846838655907868,
     'robots': 1.7047391749062393e-05,
     'acting': 0.0004388124913184579,
     'below': 4.356555669204834e-05,
     'average': 7.513480067179352e-05,
     'likes': 6.250710307989544e-05,
     're': 0.0007147276837014307,
     'likely': 0.00010354712025356416,
     'work': 0.0006440125771868015,
     'halloween': 3.788309277569421e-05,
     'h20': 4.4196941571643245e-06,
     'wasted': 7.45034157921986e-05,
     'real': 0.0005777171648293366,
     'star': 0.0004804838933717215,
     'stan': 7.5766185551388415e-06,
     'winston': 2.5255395183796137e-06,
     'robot': 2.8412319581770656e-05,
     'design': 5.4930484524756604e-05,
     'schnazzy': 6.313848795949034e-07,
     'cgi': 3.1569243979745175e-05,
     'occasional': 3.914586253488402e-05,
     'shot': 0.00021972193809902642,
     'picking': 1.7678776628657298e-05,
     'brain': 5.8718793802326025e-05,
     'if': 0.0017672462779861349,
     'body': 0.00016984253261102903,
     'parts': 0.000130696670076145,
     'turn': 0.00022919271129294997,
     'otherwise': 9.849604121680494e-05,
     'much': 0.0012937076182899573,
     'sunken': 2.5255395183796137e-06,
     'jaded': 7.5766185551388415e-06,
     'viewer': 0.00013764190375168894,
     'thankful': 4.4196941571643245e-06,
     'invention': 6.945233675543938e-06,
     'timex': 6.313848795949034e-07,
     'indiglo': 6.313848795949034e-07,
     'based': 0.00024560871816241747,
     'late': 0.00015026960134358703,
     '1960': 1.3890467351087876e-05,
     'television': 0.00013890467351087877,
     'show': 0.00046785619577982345,
     'name': 0.00024750287280120216,
     'mod': 1.073354295311336e-05,
     'squad': 2.525539518379614e-05,
     'tells': 0.00016100314429670038,
     'tale': 0.00013637913399249915,
     'three': 0.0004388124913184579,
     'reformed': 4.4196941571643245e-06,
     'criminals': 2.209847078582162e-05,
     'under': 0.00022666717177457035,
     'employ': 1.0102158073518455e-05,
     'police': 0.00015216375598237173,
     'undercover': 1.7678776628657298e-05,
     'however': 0.0006244396459193595,
     'wrong': 0.00024308317864403783,
     'evidence': 4.167140205326363e-05,
     'gets': 0.0005461479208495915,
     'stolen': 3.66203230165044e-05,
     'immediately': 0.00010291573537396926,
     'suspicion': 1.1996312712303165e-05,
     'ads': 2.0835701026631814e-05,
     'cuts': 3.788309277569421e-05,
     'claire': 4.419694157164324e-05,
     'dane': 3.1569243979745174e-06,
     'nice': 0.0002171963985806468,
     'hair': 6.882095187584447e-05,
     'cute': 8.460557386571707e-05,
     'outfits': 1.3259082471492973e-05,
     'car': 0.000202674546349964,
     'chases': 3.1569243979745175e-05,
     'stuff': 0.0001313280549557399,
     'blowing': 1.641600686946749e-05,
     'sounds': 8.397418898612215e-05,
     'first': 0.0011592226389362428,
     'fifteen': 4.040863229407382e-05,
     'quickly': 0.00016100314429670038,
     'becomes': 0.00033210844666691923,
     'apparent': 6.313848795949035e-05,
     'certainly': 0.00022792994153376014,
     'slick': 2.4624010304201235e-05,
     'looking': 0.0003163238246770466,
     'complete': 0.00012438282128019598,
     'costumes': 4.4828326451238144e-05,
     'isn': 0.0005499362301271609,
     'enough': 0.0005745602404313621,
     'best': 0.0008416360445000063,
     'described': 3.59889381369095e-05,
     'cross': 7.008372163503428e-05,
     'between': 0.0006092864088090819,
     'hour': 0.00022414163225619073,
     'long': 0.0005278377593413393,
     'cop': 0.0001313280549557399,
     'stretched': 1.1996312712303165e-05,
     'span': 1.1996312712303165e-05,
     'single': 0.00015090098622318193,
     'clich': 4.545971133083305e-05,
     'matter': 0.000202674546349964,
     'elements': 0.0001490068315843972,
     'recycled': 1.5153237110277683e-05,
     'everything': 0.0003346339861852988,
     'already': 0.0001824702302029271,
     'seen': 0.0005745602404313621,
     'nothing': 0.0005076334431943024,
     'spectacular': 5.2404945006376986e-05,
     'sometimes': 0.00017489361164778827,
     'bordering': 3.7883092775694207e-06,
     'wooden': 3.0306474220555366e-05,
     'danes': 1.641600686946749e-05,
     'omar': 7.5766185551388415e-06,
     'epps': 1.0102158073518455e-05,
     'deliver': 5.808740892273112e-05,
     'their': 0.0019711835940952886,
     'lines': 0.00020204316147036912,
     'bored': 5.2404945006376986e-05,
     'transfers': 1.8941546387847104e-06,
     'onto': 7.513480067179352e-05,
     'escape': 9.975881097599475e-05,
     'relatively': 4.167140205326363e-05,
     'unscathed': 5.051079036759227e-06,
     'giovanni': 8.839388314328649e-06,
     'ribisi': 1.5153237110277683e-05,
     'plays': 0.0004748014294553674,
     'resident': 5.051079036759227e-06,
     'crazy': 6.250710307989544e-05,
     'man': 0.0008814132919144853,
     'ultimately': 9.975881097599475e-05,
     'being': 0.0008447929688979809,
     'worth': 0.0002014117765907742,
     'watching': 0.0003112727456402874,
     'unfortunately': 0.00024118902400525313,
     'save': 0.00017236807212940865,
     'convoluted': 1.957293126744201e-05,
     'apart': 7.45034157921986e-05,
     'occupying': 3.1569243979745174e-06,
     'screen': 0.0004451263401144069,
     'young': 0.00046911896553901325,
     'cast': 0.00048553497240848075,
     'clothes': 3.220062885934008e-05,
     'hip': 4.356555669204834e-05,
     'soundtrack': 9.344496218004572e-05,
     'appears': 0.00015342652574156155,
     'geared': 8.839388314328649e-06,
     'towards': 0.00011491204808627243,
     'teenage': 6.503264259827506e-05,
     'mindset': 6.313848795949035e-06,
     'r': 0.00011364927832708262,
     'rating': 9.533911681883042e-05,
     'content': 4.8616635728807565e-05,
     'justify': 1.452185223068278e-05,
     'juvenile': 1.3890467351087876e-05,
     'older': 6.503264259827506e-05,
     'information': 6.313848795949035e-05,
     'literally': 6.692679723705976e-05,
     'spoon': 1.3890467351087876e-05,
     'hard': 0.0003706229243222083,
     'instead': 0.00035673245697112046,
     'telling': 8.397418898612215e-05,
     'dialogue': 0.0003276887525097549,
     'poorly': 5.935017868192092e-05,
     'written': 0.00025823641575431554,
     'extremely': 0.00015658345013953607,
     'predictable': 0.00011491204808627243,
     'progresses': 2.967508934096046e-05,
     'won': 0.00020961978002550794,
     'care': 0.00019194100339685064,
     'heroes': 6.376987283908525e-05,
     'any': 0.0009937998004823782,
     'jeopardy': 1.7678776628657298e-05,
     'll': 0.0003643090755262593,
     'aren': 0.0001641600686946749,
     'basing': 2.5255395183796137e-06,
     'nobody': 5.55618694043515e-05,
     'remembers': 5.682463916354131e-06,
     'questionable': 1.262769759189807e-05,
     'wisdom': 2.209847078582162e-05,
     'especially': 0.000287911505095276,
     'considers': 1.1996312712303165e-05,
     'target': 5.935017868192092e-05,
     'fact': 0.0005082648280738972,
     'number': 0.00014016744327006856,
     'memorable': 9.28135773004508e-05,
     'can': 0.0018196512229925119,
     'counted': 8.208003434733744e-06,
     'hand': 0.00023866348448687351,
     'missing': 7.32406460330088e-05,
     'finger': 1.5784621989872588e-05,
     'times': 0.00035862661160990516,
     'checked': 4.4196941571643245e-06,
     'six': 9.28135773004508e-05,
     'clear': 0.00011617481784546224,
     'indication': 6.945233675543938e-06,
     'them': 0.0011851094189996338,
     'than': 0.0015620461921177912,
     'cash': 5.808740892273112e-05,
     'spending': 2.904370446136556e-05,
     'dollar': 3.472616837771969e-05,
     'judging': 2.146708590622672e-05,
     'rash': 4.4196941571643245e-06,
     'awful': 8.334280410652726e-05,
     'seeing': 0.00021403947418267228,
     'avoid': 5.7456024043136216e-05,
     'at': 0.0031480850096601886,
     'costs': 1.5784621989872588e-05,
     'quest': 4.356555669204834e-05,
     'camelot': 6.945233675543938e-06,
     'warner': 3.0306474220555366e-05,
     'bros': 1.5153237110277683e-05,
     'feature': 0.0001452185223068278,
     'length': 6.187571820030054e-05,
     'fully': 6.440125771868016e-05,
     'animated': 0.00011301789344748772,
     'steal': 4.419694157164324e-05,
     'clout': 5.682463916354131e-06,
     'disney': 0.000183101615082522,
     'cartoon': 5.55618694043515e-05,
     'empire': 2.588678006339104e-05,
     'mouse': 3.220062885934008e-05,
     'reason': 0.00027591519238297284,
     'worried': 1.83101615082522e-05,
     'other': 0.001229937745450872,
     'recent': 0.00013322220959452463,
     'challenger': 1.2627697591898068e-06,
     'throne': 1.1364927832708262e-05,
     'last': 0.0005322574534985036,
     'fall': 0.00015090098622318193,
     'promising': 3.409478349812479e-05,
     'flawed': 3.093785910015027e-05,
     '20th': 1.7678776628657298e-05,
     'century': 7.639757043098331e-05,
     'fox': 7.008372163503428e-05,
     'anastasia': 1.3890467351087876e-05,
     'hercules': 1.0102158073518455e-05,
     'lively': 2.020431614703691e-05,
     'colorful': 3.220062885934008e-05,
     'palate': 2.5255395183796137e-06,
     'had': 0.0009761210238537208,
     'beat': 4.4828326451238144e-05,
     'hands': 9.344496218004572e-05,
     'crown': 9.470773193923552e-06,
     '1997': 7.071510651462919e-05,
     'piece': 0.00015405791062115645,
     'animation': 8.965665290247629e-05,
     'year': 0.0005594070033210844,
     'contest': 1.5153237110277683e-05,
     'arrival': 2.336124054501143e-05,
     'magic': 5.808740892273112e-05,
     'kingdom': 1.1996312712303165e-05,
     'mediocre': 4.672248109002286e-05,
     '--': 0.0011459635564647498,
     'd': 0.0003807250823957268,
     'pocahontas': 6.945233675543938e-06,
     'those': 0.000640855652788827,
     'keeping': 5.55618694043515e-05,
     'score': 0.00013385359447411953,
     'nearly': 0.00019383515803563536,
     'dull': 8.460557386571707e-05,
     'revolves': 3.283201373893498e-05,
     'adventures': 3.346339861852988e-05,
     'free': 0.00010039019585558965,
     'spirited': 2.714954982258085e-05,
     'kayley': 2.5255395183796137e-06,
     'voiced': 3.59889381369095e-05,
     'jessalyn': 6.313848795949034e-07,
     'gilsig': 6.313848795949034e-07,
     'early': 0.00019130961851725574,
     'daughter': 0.0002001490068315844,
     'belated': 1.2627697591898068e-06,
     'knight': 2.336124054501143e-05,
     'king': 0.00016163452917629528,
     'arthur': 2.8412319581770656e-05,
     'round': 3.093785910015027e-05,
     'table': 3.346339861852988e-05,
     'dream': 0.00010354712025356416,
     'follow': 0.00011680620272505714,
     'father': 0.0003106413607606925,
     'footsteps': 1.073354295311336e-05,
     'she': 0.001983179906807592,
     'chance': 0.00014079882814966346,
     'evil': 0.0002708641133462136,
     'warlord': 1.8941546387847104e-06,
     'ruber': 6.313848795949034e-07,
     'gary': 4.8616635728807565e-05,
     'oldman': 2.0835701026631814e-05,
     'ex': 0.00010417850513315907,
     'gone': 0.00012312005152100618,
     'steals': 3.72517078960993e-05,
     'magical': 3.220062885934008e-05,
     'sword': 2.778093470217575e-05,
     'excalibur': 1.8941546387847104e-06,
     'accidentally': 3.59889381369095e-05,
     'loses': 5.3667714765566795e-05,
     'dangerous': 5.1142175247187183e-05,
     'booby': 2.5255395183796137e-06,
     'trapped': 3.283201373893498e-05,
     'forest': 2.8412319581770656e-05,
     'help': 0.00033905368034246316,
     'hunky': 7.5766185551388415e-06,
     'blind': 2.778093470217575e-05,
     'timberland': 1.2627697591898068e-06,
     'dweller': 1.2627697591898068e-06,
     'garrett': 5.682463916354131e-06,
     'carey': 8.208003434733744e-06,
     'elwes': 3.7883092775694207e-06,
     'headed': 4.735386596961776e-05,
     'dragon': 3.5357553257314596e-05,
     'eric': 4.040863229407382e-05,
     'idle': 1.452185223068278e-05,
     'rickles': 2.5255395183796137e-06,
     'arguing': 1.073354295311336e-05,
     'itself': 0.00025823641575431554,
     'able': 0.00021403947418267228,
     'medieval': 1.073354295311336e-05,
     'sexist': 8.839388314328649e-06,
     'prove': 6.440125771868016e-05,
     'fighter': 2.020431614703691e-05,
     'side': 0.00021530224394186208,
     'pure': 5.682463916354131e-05,
     'showmanship': 2.5255395183796137e-06,
     'essential': 2.146708590622672e-05,
     'element': 9.470773193923553e-05,
     'expected': 8.713111338409668e-05,
     'climb': 1.0102158073518455e-05,
     'high': 0.00039398416486721976,
     'ranks': 1.5153237110277683e-05,
     'differentiates': 1.2627697591898068e-06,
     'something': 0.0006698993572501926,
     'saturday': 3.346339861852988e-05,
     'morning': 4.167140205326363e-05,
     'subpar': 1.8941546387847104e-06,
     'instantly': 2.588678006339104e-05,
     'forgettable': 1.8941546387847104e-05,
     'songs': 7.513480067179352e-05,
     'integrated': 4.4196941571643245e-06,
     'computerized': 2.5255395183796137e-06,
     'footage': 6.566402747786996e-05,
     'compare': 2.588678006339104e-05,
     'run': 0.00022351024737659583,
     'angry': 5.619325428394641e-05,
     'ogre': 1.262769759189807e-05,
     'herc': 1.2627697591898068e-06,
     'battle': 0.0001452185223068278,
     'hydra': 1.2627697591898068e-06,
     'rest': 0.0002721268831054034,
     'case': 0.00026518164942985947,
     'stink': 3.1569243979745174e-06,
     'none': 0.00015279514086196663,
     'remotely': 3.1569243979745175e-05,
     'interesting': 0.0004028235531815484,
     'race': 8.018587970855274e-05,
     'bland': 5.303632988597189e-05,
     'end': 0.0006705307421297874,
     'tie': 2.146708590622672e-05,
     'win': 7.071510651462919e-05,
     'comedy': 0.0005303632988597189,
     'shtick': 8.839388314328649e-06,
     'awfully': 1.7047391749062393e-05,
     'cloying': 3.1569243979745174e-06,
     'least': 0.0004268161786061547,
     'signs': 3.346339861852988e-05,
     'pulse': 1.452185223068278e-05,
     'fans': 0.00015468929550075135,
     "-'": 1.8941546387847104e-06,
     '90s': 2.588678006339104e-05,
     'tgif': 1.2627697591898068e-06,
     'will': 0.0013991488931823061,
     'thrilled': 9.470773193923552e-06,
     'jaleel': 6.313848795949034e-07,
     'urkel': 1.2627697591898068e-06,
     'white': 0.00019825485219279967,
     'bronson': 1.262769759189807e-05,
     'balki': 6.313848795949034e-07,
     'pinchot': 1.2627697591898068e-06,
     'sharing': 8.839388314328649e-06,
     'nicely': 6.187571820030054e-05,
     'realized': 5.55618694043515e-05,
     'though': 0.0005935017868192093,
     'm': 0.00045901680746549483,
     'loss': 3.409478349812479e-05,
     'recall': 3.283201373893498e-05,
     'specific': 2.2729855665416524e-05,
     'providing': 2.904370446136556e-05,
     'voice': 0.00017363084188859844,
     'talent': 0.00014079882814966346,
     'enthusiastic': 1.1364927832708262e-05,
     'paired': 5.682463916354131e-06,
     'singers': 6.313848795949035e-06,
     'sound': 0.00015468929550075135,
     'musical': 9.723327145761513e-05,
     'moments': 0.00028222904117892187,
     'jane': 5.2404945006376986e-05,
     'seymour': 5.051079036759227e-06,
     'celine': 6.313848795949035e-06,
     'dion': 1.2627697591898068e-06,
     'must': 0.0003901958555896503,
     'strain': 8.839388314328649e-06,
     'through': 0.0007513480067179351,
     'aside': 7.45034157921986e-05,
     'children': 0.00021214531954388756,
     'probably': 0.00034031645010165296,
     'adults': 5.3667714765566795e-05,
     'grievous': 1.8941546387847104e-06,
     'error': 9.470773193923552e-06,
     'lack': 0.0001496382164639921,
     'personality': 7.32406460330088e-05,
     'learn': 0.0001085981992903234,
     'goes': 0.0004078746322183076,
     'synopsis': 4.230278693285853e-05,
     'mentally': 2.336124054501143e-05,
     'unstable': 9.470773193923552e-06,
     'undergoing': 1.8941546387847104e-06,
     'psychotherapy': 1.2627697591898068e-06,
     'saves': 2.714954982258085e-05,
     'boy': 0.00022856132641335504,
     'potentially': 2.4624010304201235e-05,
     'fatal': 2.4624010304201235e-05,
     'falls': 0.00015090098622318193,
     'love': 0.000706519680266697,
     'mother': 0.00027591519238297284,
     'fledgling': 4.4196941571643245e-06,
     'restauranteur': 1.2627697591898068e-06,
     'unsuccessfully': 5.682463916354131e-06,
     'attempting': 3.472616837771969e-05,
     'gain': 2.6518164942985945e-05,
     'woman': 0.00034978722329557653,
     'favor': 2.967508934096046e-05,
     'takes': 0.0004255534088469649,
     'pictures': 7.387203091260371e-05,
     'kills': 4.924802060840247e-05,
     'comments': 3.346339861852988e-05,
     'stalked': 1.452185223068278e-05,
     'yet': 0.0003838820067937013,
     'seemingly': 7.829172506976803e-05,
     'endless': 3.59889381369095e-05,
     'string': 2.4624010304201235e-05,
     'spurned': 2.5255395183796137e-06,
     'psychos': 2.5255395183796137e-06,
     'getting': 0.0002563422611155308,
     'revenge': 6.313848795949035e-05,
     'type': 0.00013511636423330935,
     'stable': 9.470773193923552e-06,
     'category': 2.525539518379614e-05,
     '1990s': 1.452185223068278e-05,
     'industry': 5.4930484524756604e-05,
     'theatrical': 3.851447765528911e-05,
     'direct': 4.8616635728807565e-05,
     'proliferation': 1.8941546387847104e-06,
     'may': 0.0005410968418128322,
     'due': 0.00012375143640060108,
     'typically': 1.7678776628657298e-05,
     'inexpensive': 1.8941546387847104e-06,
     'produce': 2.778093470217575e-05,
     'special': 0.0003624149208874746,
     'effects': 0.00040976878685709237,
     'stars': 0.0002519225669583665,
     'serve': 4.9879405487997374e-05,
     'vehicles': 1.5784621989872588e-05,
     'nudity': 4.6091096210427954e-05,
     'allowing': 2.6518164942985945e-05,
     'frequent': 2.209847078582162e-05,
     'night': 0.000274652422623783,
     'cable': 3.093785910015027e-05,
     'wavers': 6.313848795949034e-07,
     'slightly': 9.533911681883042e-05,
     'norm': 1.641600686946749e-05,
     'respect': 5.808740892273112e-05,
     'psycho': 3.851447765528911e-05,
     'never': 0.0008675228245633974,
     'affair': 6.061294844111073e-05,
     ';': 0.0011680620272505715,
     'contrary': 1.7047391749062393e-05,
     'rejected': 1.1996312712303165e-05,
     'rather': 0.00039209001022843506,
     'lover': 5.935017868192092e-05,
     'wife': 0.0003712543092018032,
     'husband': 0.0001641600686946749,
     'entry': 2.8412319581770656e-05,
     'doomed': 1.83101615082522e-05,
     'collect': 1.1996312712303165e-05,
     'dust': 1.3259082471492973e-05,
     'viewed': 2.8412319581770656e-05,
     'midnight': 3.1569243979745175e-05,
     'provide': 7.955449482895784e-05,
     'suspense': 0.0001275397456781705,
     'sets': 0.00015216375598237173,
     'interspersed': 3.1569243979745174e-06,
     'opening': 0.00019320377315604046,
     'credits': 0.0001281711305577654,
     'instance': 4.735386596961776e-05,
     'serious': 0.00013637913399249915,
     'sounding': 2.146708590622672e-05,
     'narrator': 2.336124054501143e-05,
     'spouts': 2.5255395183796137e-06,
     'statistics': 6.313848795949034e-07,
     'stalkers': 1.2627697591898068e-06,
     'ponders': 4.4196941571643245e-06,
     'cause': 6.187571820030054e-05,
     'stalk': 2.5255395183796137e-06,
     'implicitly': 1.8941546387847104e-06,
     'implied': 5.682463916354131e-06,
     'men': 0.0003358967559444886,
     'shown': 8.271141922693236e-05,
     'snapshot': 6.313848795949034e-07,
     'actor': 0.0003447361442588173,
     'jay': 6.313848795949035e-05,
     'underwood': 6.945233675543938e-06,
     'states': 6.945233675543938e-05,
     'daryl': 1.5153237110277683e-05,
     'gleason': 1.2627697591898068e-06,
     'stalker': 6.313848795949035e-06,
     'brooke': 8.208003434733744e-06,
     'daniels': 1.7047391749062393e-05,
     'meant': 5.7456024043136216e-05,
     'called': 0.00024687148792160727,
     'guesswork': 6.313848795949034e-07,
     'required': 3.346339861852988e-05,
     'proceeds': 1.83101615082522e-05,
     'begins': 0.00024750287280120216,
     'obvious': 0.00018436438484171181,
     'sequence': 0.00023108686593173466,
     'contrived': 4.8616635728807565e-05,
     'quite': 0.0004167140205326363,
     'brings': 0.0001275397456781705,
     'victim': 7.134649139422409e-05,
     'together': 0.0003295829071485396,
     'obsesses': 2.5255395183796137e-06,
     'follows': 0.00010733542953113359,
     'tries': 0.00023361240545011428,
     'woo': 5.935017868192092e-05,
     'plans': 5.682463916354131e-05,
     'become': 0.00032263767347299565,
     'desperate': 6.376987283908525e-05,
     'elaborate': 3.977724741447892e-05,
     'include': 6.945233675543938e-05,
     'cliche': 4.1040017173668724e-05,
     'murdered': 3.472616837771969e-05,
     'pet': 2.525539518379614e-05,
     'require': 2.2729855665416524e-05,
     'found': 0.00025129118207877155,
     'exception': 6.440125771868016e-05,
     'cat': 3.72517078960993e-05,
     'shower': 1.957293126744201e-05,
     'events': 0.0001269083607985756,
     'lead': 0.00015847760477832076,
     'inevitable': 4.419694157164324e-05,
     'showdown': 2.336124054501143e-05,
     'survives': 1.262769759189807e-05,
     'invariably': 3.7883092775694207e-06,
     'conclusion': 7.702895531057822e-05,
     'turkey': 2.525539518379614e-05,
     'uniformly': 9.470773193923552e-06,
     'adequate': 2.399262542460633e-05,
     'anything': 0.0003901958555896503,
     'home': 0.0003472616837771969,
     'either': 0.00024371456352363272,
     'turns': 0.0002544481064767461,
     'toward': 6.313848795949035e-05,
     'melodrama': 2.2729855665416524e-05,
     'overdoes': 2.5255395183796137e-06,
     'words': 0.00013574774911290425,
     'manages': 0.00015658345013953607,
     'creepy': 5.8718793802326025e-05,
     'pass': 6.187571820030054e-05,
     'demands': 2.778093470217575e-05,
     'maryam': 6.313848795949034e-07,
     'abo': 1.8941546387847104e-06,
     'close': 0.0001824702302029271,
     'played': 0.0004994254397595687,
     'bond': 9.786465633721004e-05,
     'chick': 2.0835701026631814e-05,
     'living': 0.00014774406182520742,
     'daylights': 6.313848795949034e-07,
     'equally': 6.945233675543938e-05,
     'title': 0.00018752130923968633,
     'ditzy': 8.839388314328649e-06,
     'strong': 0.00016921114773143413,
     'independent': 2.8412319581770656e-05,
     'business': 0.00012185728176181636,
     'owner': 6.250710307989544e-05,
     'needs': 0.00013953605839047366,
     'proceed': 1.641600686946749e-05,
     'example': 0.00018941546387847105,
     'suspicions': 3.1569243979745174e-06,
     'ensure': 9.470773193923552e-06,
     'use': 0.00025129118207877155,
     'excuse': 4.735386596961776e-05,
     'decides': 0.00011933174224343676,
     'return': 0.00012312005152100618,
     'toolbox': 1.2627697591898068e-06,
     'left': 0.0002607619552726951,
     'place': 0.0003883017009508656,
     ...}




```python
corpus_word_freq['the'] #high p(w) for a stopword
```




    0.048319253450518365




```python
corpus_word_freq['computer'] #lower p(w) for a word carrying meaning in a more specific context
```




    0.00017236807212940865



### Computing $s(w)$ for each word contained in the Movie Reviews Corpus


```python
corpus_sif_weighting = {k:a_hp/(a_hp+p) for (k,p) in corpus_word_freq.items()}
```


```python
corpus_sif_weighting
```




    {'plot': 0.5114343100341641,
     ':': 0.342386863302074,
     'two': 0.45319072226895807,
     'teen': 0.9129592695495786,
     'couples': 0.9832383506537045,
     'go': 0.5872916991122877,
     'to': 0.047248844151187235,
     'a': 0.03990494287955954,
     'church': 0.9582531673140451,
     'party': 0.8964240839474311,
     ',': 0.019972302934572427,
     'drink': 0.980195813890161,
     'and': 0.042621842624641346,
     'then': 0.5265674142734605,
     'drive': 0.9378264113404625,
     '.': 0.023477975482294498,
     'they': 0.24713129718107235,
     'get': 0.44831607610917057,
     'into': 0.3764886541378048,
     'an': 0.21613795098678731,
     'accident': 0.938382054958467,
     'one': 0.21299870088302297,
     'of': 0.044356232226784684,
     'the': 0.020276057118408988,
     'guys': 0.8552775107731853,
     'dies': 0.938382054958467,
     'but': 0.1550056665707558,
     'his': 0.1417818924662648,
     'girlfriend': 0.8790112219866579,
     'continues': 0.9473627543635081,
     'see': 0.4752191837542982,
     'him': 0.3755958281358939,
     'in': 0.06766778519188817,
     'her': 0.2593951344782519,
     'life': 0.49965613189392455,
     'has': 0.2512875189201024,
     'nightmares': 0.9838491259892411,
     'what': 0.32284511050140446,
     "'": 0.04923463154694514,
     's': 0.0788094832913864,
     'deal': 0.878523646287483,
     '?': 0.29577464788732394,
     'watch': 0.7242571405053915,
     'movie': 0.21534449517459298,
     '"': 0.08250858780713718,
     'sorta': 0.9937257657702877,
     'find': 0.6694592149867699,
     'out': 0.30336613788638567,
     'critique': 0.9629138750744762,
     'mind': 0.7783587737490295,
     '-': 0.09219608797344638,
     'fuck': 0.9893804425232068,
     'for': 0.13718879982537624,
     'generation': 0.9428510197521164,
     'that': 0.09046357570502782,
     'touches': 0.9664392672776755,
     'on': 0.17659179245430282,
     'very': 0.4595018016606611,
     'cool': 0.8839169112968938,
     'idea': 0.8040430090058991,
     'presents': 0.9530635086832508,
     'it': 0.08952778898886542,
     'bad': 0.5316937579309928,
     'package': 0.9814105662341526,
     'which': 0.3337998069473658,
     'is': 0.05914450300648049,
     'makes': 0.6148799217336615,
     'this': 0.14189621405828082,
     'review': 0.8429865553911499,
     'even': 0.38175191982298584,
     'harder': 0.9795895647010799,
     'write': 0.930115925347365,
     'since': 0.6734443962548154,
     'i': 0.15123147347132865,
     'generally': 0.9389383573825305,
     'applaud': 0.9937257657702877,
     'films': 0.5076639036867512,
     'attempt': 0.8575930518404609,
     'break': 0.9005014725782059,
     'mold': 0.9912380618592832,
     'mess': 0.9087685475264227,
     'with': 0.127976974455026,
     'your': 0.6486227486055484,
     'head': 0.8036350351630286,
     'such': 0.5650808828251547,
     '(': 0.1195532547996576,
     'lost': 0.7947631998875965,
     'highway': 0.9826283331885693,
     '&': 0.8438848690870728,
     'memento': 0.9937257657702877,
     ')': 0.11850664655416233,
     'there': 0.2958298934218932,
     'are': 0.18561507215668444,
     'good': 0.3964684266124631,
     'ways': 0.8933901918976546,
     'making': 0.724588483955678,
     'all': 0.265883474739878,
     'types': 0.9705849909916535,
     'these': 0.5475003629676233,
     'folks': 0.9553630671604879,
     'just': 0.35283660293796587,
     'didn': 0.7322939495658446,
     't': 0.19813055585439754,
     'snag': 0.9987388228172175,
     'correctly': 0.9893804425232068,
     'seem': 0.7339907869979888,
     'have': 0.24423499804158016,
     'taken': 0.8756095133844164,
     'pretty': 0.7499786913657414,
     'neat': 0.980195813890161,
     'concept': 0.9328550729759337,
     'executed': 0.9717760243462468,
     'terribly': 0.9646733503063674,
     'so': 0.3007165614165664,
     'problems': 0.8438848690870728,
     'well': 0.453840026133153,
     'its': 0.41097404653045544,
     'main': 0.7987714467273883,
     'problem': 0.7999818165287754,
     'simply': 0.7872573093020251,
     'too': 0.5010788339734626,
     'jumbled': 0.9924803549272475,
     'starts': 0.8336684528007917,
     'off': 0.5004455229681309,
     'normal': 0.934506319255142,
     'downshifts': 0.9987388228172175,
     'fantasy': 0.9422900727026094,
     'world': 0.604322311337673,
     'you': 0.22954511856831047,
     'as': 0.12219117377035017,
     'audience': 0.6340809185609853,
     'member': 0.9263080324244657,
     'no': 0.3905054958060269,
     'going': 0.6407505400878705,
     'dreams': 0.923607142440606,
     'characters': 0.4600356684345972,
     'coming': 0.8520566811202805,
     'back': 0.5990649892957918,
     'from': 0.2405990137965188,
     'dead': 0.791190017084453,
     'others': 0.8461390518319069,
     'who': 0.21768268044014283,
     'look': 0.654790352320553,
     'like': 0.3003174169766886,
     'strange': 0.8954104996551373,
     'apparitions': 0.9968530104102417,
     'disappearances': 0.9981094263999697,
     'looooot': 0.9993690135157306,
     'chase': 0.9087685475264227,
     'scenes': 0.5542056532601773,
     'tons': 0.9869144203088196,
     'weird': 0.9406112292287774,
     'things': 0.6502204596398748,
     'happen': 0.878036611191804,
     'most': 0.40717051174604485,
     'not': 0.22117858010674757,
     'explained': 0.9576737492592907,
     'now': 0.6148799217336615,
     'personally': 0.9729699843963092,
     'don': 0.550354087468987,
     'trying': 0.7367221441795128,
     'unravel': 0.9943496440275739,
     'film': 0.14267594646161275,
     'every': 0.6258129776119993,
     'when': 0.327112532064389,
     'does': 0.5025096610847066,
     'give': 0.738439589336168,
     'me': 0.5283239153785084,
     'same': 0.6454507665598944,
     'clue': 0.9723726378605372,
     'over': 0.5227439253817059,
     'again': 0.6947127404795116,
     'kind': 0.7391288115660671,
     'fed': 0.9820190721841247,
     'up': 0.3174738715768458,
     'after': 0.47337274569462795,
     'while': 0.5071762061213902,
     'biggest': 0.9140129961565541,
     'obviously': 0.8741596847368944,
     'got': 0.7711581345979687,
     'big': 0.5981599957701053,
     'secret': 0.8959170051249561,
     'hide': 0.9753667278392926,
     'seems': 0.6052460620142005,
     'want': 0.7387840397048261,
     'completely': 0.7825893607138974,
     'until': 0.7860851093397921,
     'final': 0.80649957735434,
     'five': 0.8479510873638788,
     'minutes': 0.710928171934896,
     'do': 0.45267261533888564,
     'make': 0.490982137875021,
     'entertaining': 0.8345470065654277,
     'thrilling': 0.9717760243462468,
     'or': 0.3347168742682519,
     'engaging': 0.9524903477225436,
     'meantime': 0.9881458928638276,
     'really': 0.5041090832702064,
     'sad': 0.9361634216406001,
     'part': 0.6892707000548346,
     'arrow': 0.9820190721841247,
     'both': 0.63945704572799,
     'dig': 0.9881458928638276,
     'flicks': 0.9513460914693481,
     'we': 0.36335980838850884,
     'actually': 0.6542493865714923,
     'figured': 0.9820190721841247,
     'by': 0.20189373369943478,
     'half': 0.7475009675196571,
     'way': 0.48334055578274066,
     'point': 0.6980809407533431,
     'strangeness': 0.9962259878476808,
     'did': 0.6748791982342063,
     'start': 0.8354274139949995,
     'little': 0.5134237978228876,
     'bit': 0.7360374008978446,
     'sense': 0.7405111229556485,
     'still': 0.6020252240746231,
     'more': 0.3212082371694769,
     'guess': 0.8751257031085965,
     'bottom': 0.9445378752638923,
     'line': 0.7845275953279639,
     'movies': 0.5677140460674882,
     'should': 0.6449251166616446,
     'always': 0.7299315150565484,
     'sure': 0.7517585745341321,
     'before': 0.6148799217336615,
     'given': 0.7593272669741398,
     'password': 0.9974808227632855,
     'enter': 0.9588332869198822,
     'understanding': 0.9652612718031228,
     'mean': 0.8674568139247023,
     'showing': 0.9150691579713661,
     'melissa': 0.9924803549272475,
     'sagemiller': 0.9949743061401415,
     'running': 0.8306080280257182,
     'away': 0.7074351667396217,
     'visions': 0.9808028139359185,
     'about': 0.31013820733842196,
     '20': 0.9417297927245484,
     'throughout': 0.8398574625361912,
     'plain': 0.9507749936967979,
     'lazy': 0.9789840649763263,
     '!': 0.4804083935428685,
     'okay': 0.9268501070914433,
     'people': 0.5211957272888819,
     'chasing': 0.9735680653053196,
     'know': 0.565484393856085,
     'need': 0.8336684528007917,
     'how': 0.5107745693074736,
     'giving': 0.8809669488602864,
     'us': 0.5961337237750394,
     'different': 0.7864754546086542,
     'offering': 0.9765695329937972,
     'further': 0.9219941553829855,
     'insight': 0.9670293438839432,
     'down': 0.6250720256371802,
     'apparently': 0.883423879697906,
     'studio': 0.9066875808612221,
     'took': 0.906168827453628,
     'director': 0.5614750320828695,
     'chopped': 0.9968530104102417,
     'themselves': 0.8484053095638573,
     'shows': 0.7943645865725091,
     'might': 0.7138118459361282,
     've': 0.6545197576679257,
     'been': 0.4358553808388968,
     'decent': 0.906168827453628,
     'here': 0.5714007403078122,
     'somewhere': 0.9257665914590665,
     'suits': 0.9723726378605372,
     'decided': 0.938382054958467,
     'turning': 0.9519178757317498,
     'music': 0.7674215774631509,
     'video': 0.8310438551384706,
     'edge': 0.938382054958467,
     'would': 0.4288917412708987,
     'actors': 0.6916788219161332,
     'although': 0.6658006910989481,
     'wes': 0.9693968735846054,
     'bentley': 0.9943496440275739,
     'seemed': 0.8819480794288961,
     'be': 0.2041578690920903,
     'playing': 0.8139601813117349,
     'exact': 0.9611608063987571,
     'character': 0.4394836590062767,
     'he': 0.15159334674601974,
     'american': 0.7391288115660671,
     'beauty': 0.9214577442664154,
     'only': 0.38830347992801834,
     'new': 0.5507368333205834,
     'neighborhood': 0.9869144203088196,
     'my': 0.5318723092732267,
     'kudos': 0.9869144203088196,
     'holds': 0.9462307775029573,
     'own': 0.6602496227311762,
     'entire': 0.7951622134530228,
     'feeling': 0.8756095133844164,
     'unraveling': 0.9987388228172175,
     'overall': 0.9082474108566252,
     'doesn': 0.5536244852874351,
     'stick': 0.9582531673140451,
     'because': 0.48467173834544136,
     'entertain': 0.9676201414938722,
     'confusing': 0.9439749198364544,
     'rarely': 0.9394953197850304,
     'excites': 0.9987388228172175,
     'feels': 0.8799879987998799,
     'redundant': 0.9912380618592832,
     'runtime': 0.9949743061401415,
     'despite': 0.8181649120269446,
     'ending': 0.7892187640147098,
     'explanation': 0.9582531673140451,
     'craziness': 0.9974808227632855,
     'came': 0.8954104996551373,
     'oh': 0.8799879987998799,
     'horror': 0.7700333524567051,
     'slasher': 0.9496348526819441,
     'flick': 0.88987650436561,
     'packaged': 0.9981094263999697,
     'someone': 0.7979665662377444,
     'assuming': 0.9906180808346156,
     'genre': 0.8552775107731853,
     'hot': 0.9257665914590665,
     'kids': 0.8284357313973073,
     'also': 0.4460434491187951,
     'wrapped': 0.9759677598254889,
     'production': 0.8407491161575946,
     'years': 0.6518260611897178,
     'ago': 0.8883790848206773,
     'sitting': 0.9445378752638923,
     'shelves': 0.9918588194035645,
     'ever': 0.6711613597647278,
     'whatever': 0.9209219569489829,
     'skip': 0.9723726378605372,
     'where': 0.514926101007211,
     'joblo': 0.9814105662341526,
     'nightmare': 0.9634996532467057,
     'elm': 0.9912380618592832,
     'street': 0.9187850239584179,
     '3': 0.8770641592185268,
     '7': 0.9323059535442247,
     '/': 0.6226148076514848,
     '10': 0.7791245658740076,
     'blair': 0.9417297927245484,
     'witch': 0.9361634216406001,
     '2': 0.7829762410891725,
     'crow': 0.9664392672776755,
     '9': 0.954787137844974,
     'salvation': 0.9912380618592832,
     '4': 0.8928865386566845,
     'stir': 0.9832383506537045,
     'echoes': 0.9808028139359185,
     '8': 0.9187850239584179,
     'happy': 0.8804772017211283,
     'bastard': 0.9717760243462468,
     'quick': 0.9193183269291046,
     'damn': 0.9473627543635081,
     'y2k': 0.9974808227632855,
     'bug': 0.9513460914693481,
     'starring': 0.8959170051249561,
     'jamie': 0.9741668819426504,
     'lee': 0.8562022250813593,
     'curtis': 0.977172048716082,
     'another': 0.5855546764664561,
     'baldwin': 0.9467964275893401,
     'brother': 0.8552775107731853,
     'william': 0.8849046272809556,
     'time': 0.3964684266124631,
     'story': 0.4220346299582714,
     'regarding': 0.9808028139359185,
     'crew': 0.8809669488602864,
     'tugboat': 0.9987388228172175,
     'comes': 0.683618062689376,
     'across': 0.8775501158010217,
     'deserted': 0.9869144203088196,
     'russian': 0.9588332869198822,
     'tech': 0.9820190721841247,
     'ship': 0.8571289411306295,
     'kick': 0.9682116614297417,
     'power': 0.8693614078229462,
     'within': 0.8746424271876829,
     'gore': 0.9350580345018952,
     'bringing': 0.9513460914693481,
     'few': 0.6216373213178326,
     'action': 0.5747182326857342,
     'sequences': 0.8438848690870728,
     'virus': 0.9536373598583833,
     'empty': 0.9594141093517162,
     'flash': 0.9623288087397164,
     'substance': 0.9559396916985551,
     'why': 0.641789109416408,
     'was': 0.24277493860958763,
     'middle': 0.8770641592185268,
     'nowhere': 0.9417297927245484,
     'origin': 0.9949743061401415,
     'pink': 0.9850729559279023,
     'flashy': 0.97476643566672,
     'thing': 0.6619051997225031,
     'hit': 0.8474973512697852,
     'mir': 0.9955997535862008,
     'course': 0.7096540043551899,
     'donald': 0.9765695329937972,
     'sutherland': 0.9759677598254889,
     'stumbling': 0.9906180808346156,
     'around': 0.6368856612058773,
     'drunkenly': 0.9987388228172175,
     'hey': 0.9576737492592907,
     'let': 0.78843301042403,
     'some': 0.34665843697059634,
     'robots': 0.9832383506537045,
     'acting': 0.6950175968264277,
     'below': 0.9582531673140451,
     'average': 0.930115925347365,
     'likes': 0.9411701786287304,
     're': 0.5831829797261969,
     'likely': 0.906168827453628,
     'work': 0.6082678526165403,
     'halloween': 0.9634996532467057,
     'h20': 0.9955997535862008,
     'wasted': 0.9306624672409537,
     'real': 0.6338271664225515,
     'star': 0.6754548323538694,
     'stan': 0.9924803549272475,
     'winston': 0.9974808227632855,
     'robot': 0.9723726378605372,
     'design': 0.9479297590404712,
     'schnazzy': 0.9993690135157306,
     'cgi': 0.9693968735846054,
     'occasional': 0.9623288087397164,
     'shot': 0.8198589930738889,
     'picking': 0.9826283331885693,
     'brain': 0.9445378752638923,
     'if': 0.36137007679986854,
     'body': 0.8548159022463057,
     'parts': 0.8844104935169363,
     'turn': 0.8135420840139305,
     'otherwise': 0.9103355519536503,
     'much': 0.43597535798635767,
     'sunken': 0.9974808227632855,
     'jaded': 0.9924803549272475,
     'viewer': 0.8790112219866579,
     'thankful': 0.9955997535862008,
     'invention': 0.9931026698937812,
     'timex': 0.9993690135157306,
     'indiglo': 0.9993690135157306,
     'based': 0.8028203282610679,
     'late': 0.8693614078229462,
     '1960': 0.9862998343525426,
     'television': 0.878036611191804,
     'show': 0.6812656463726224,
     'name': 0.8016013604478142,
     'mod': 0.9893804425232068,
     'squad': 0.9753667278392926,
     'tells': 0.8613241100270826,
     'tale': 0.8799879987998799,
     'three': 0.6950175968264277,
     'reformed': 0.9955997535862008,
     'criminals': 0.9783793133269912,
     'under': 0.815217055620181,
     'employ': 0.9899988748734233,
     'police': 0.8679321796122358,
     'undercover': 0.9826283331885693,
     'however': 0.6155968936808638,
     'wrong': 0.8044513972836522,
     'evidence': 0.9599956358875514,
     'gets': 0.6467686477568788,
     'stolen': 0.9646733503063674,
     'immediately': 0.9066875808612221,
     'suspicion': 0.9881458928638276,
     'ads': 0.9795895647010799,
     'cuts': 0.9634996532467057,
     'claire': 0.9576737492592907,
     'dane': 0.9968530104102417,
     'nice': 0.821560104159102,
     'hair': 0.9356104015784312,
     'cute': 0.9219941553829855,
     'outfits': 0.9869144203088196,
     'car': 0.8314801398557343,
     'chases': 0.9693968735846054,
     'stuff': 0.8839169112968938,
     'blowing': 0.9838491259892411,
     'sounds': 0.9225311913887303,
     'first': 0.4631296384020211,
     'fifteen': 0.9611608063987571,
     'quickly': 0.8613241100270826,
     'becomes': 0.7506896322909064,
     'apparent': 0.9406112292287774,
     'certainly': 0.8143787085694305,
     'slick': 0.9759677598254889,
     'looking': 0.7596914841569057,
     'complete': 0.8893768039442504,
     'costumes': 0.9570950314837867,
     'isn': 0.6451878345459138,
     'enough': 0.6350979621624656,
     'best': 0.5429954539532779,
     'described': 0.9652612718031228,
     'cross': 0.934506319255142,
     'between': 0.6213934291162185,
     'hour': 0.8168989385296211,
     'long': 0.6545197576679257,
     'cop': 0.8839169112968938,
     'stretched': 0.9881458928638276,
     'span': 0.9881458928638276,
     'single': 0.868884475702483,
     'clich': 0.9565170127187738,
     'matter': 0.8314801398557343,
     'elements': 0.8703168445230848,
     'recycled': 0.9850729559279023,
     'everything': 0.7492690957602823,
     'already': 0.8456872523787656,
     'seen': 0.6350979621624656,
     'nothing': 0.6632912028544865,
     'spectacular': 0.9502045811785316,
     'sometimes': 0.8511408948743028,
     'bordering': 0.9962259878476808,
     'wooden': 0.9705849909916535,
     'danes': 0.9838491259892411,
     'omar': 0.9924803549272475,
     'epps': 0.9899988748734233,
     'deliver': 0.9451015025480064,
     'their': 0.3365662095022759,
     'lines': 0.8319168828985934,
     'bored': 0.9502045811785316,
     'transfers': 0.9981094263999697,
     'onto': 0.930115925347365,
     'escape': 0.909290282577993,
     'relatively': 0.9599956358875514,
     'unscathed': 0.9949743061401415,
     'giovanni': 0.9912380618592832,
     'ribisi': 0.9850729559279023,
     'plays': 0.6780573845587416,
     'resident': 0.9949743061401415,
     'crazy': 0.9411701786287304,
     'man': 0.5315153264291131,
     'ultimately': 0.909290282577993,
     'being': 0.5420662463806805,
     'worth': 0.8323540849896469,
     'watching': 0.7626178484413672,
     'unfortunately': 0.8056790550508184,
     'save': 0.8529744401719068,
     'convoluted': 0.9808028139359185,
     'apart': 0.9306624672409537,
     'occupying': 0.9968530104102417,
     'screen': 0.6919810207880044,
     'young': 0.6806800697948273,
     'cast': 0.6731581676456337,
     'clothes': 0.9688039050170661,
     'hip': 0.9582531673140451,
     'soundtrack': 0.9145407721356723,
     'appears': 0.8669819686668637,
     'geared': 0.9912380618592832,
     'towards': 0.8969317370966463,
     'teenage': 0.9389383573825305,
     'mindset': 0.9937257657702877,
     'r': 0.8979487702826818,
     'rating': 0.9129592695495786,
     'content': 0.9536373598583833,
     'justify': 0.9856860133680189,
     'juvenile': 0.9862998343525426,
     'older': 0.9389383573825305,
     'information': 0.9406112292287774,
     'literally': 0.9372714253589141,
     'spoon': 0.9862998343525426,
     'hard': 0.7295952681475203,
     'instead': 0.7370649938105565,
     'telling': 0.9225311913887303,
     'dialogue': 0.753188575341684,
     'poorly': 0.9439749198364544,
     'written': 0.7947631998875965,
     'extremely': 0.8646155189920408,
     'predictable': 0.8969317370966463,
     'progresses': 0.9711801425049975,
     'won': 0.8267060579803948,
     'care': 0.8389676981915649,
     'heroes': 0.9400529433411284,
     'any': 0.5015548701319263,
     'jeopardy': 0.9826283331885693,
     'll': 0.7329717422089762,
     'aren': 0.8589884045080322,
     'basing': 0.9974808227632855,
     'nobody': 0.9473627543635081,
     'remembers': 0.9943496440275739,
     'questionable': 0.9875297726677557,
     'wisdom': 0.9783793133269912,
     'especially': 0.7764508633114686,
     'considers': 0.9881458928638276,
     'target': 0.9439749198364544,
     'fact': 0.6630135380648187,
     'number': 0.8770641592185268,
     'memorable': 0.9150691579713661,
     'can': 0.35465379258456453,
     'counted': 0.9918588194035645,
     'hand': 0.8073217726396917,
     'missing': 0.9317574802037862,
     'finger': 0.9844606606083962,
     'times': 0.7360374008978446,
     'checked': 0.9955997535862008,
     'six': 0.9150691579713661,
     'clear': 0.8959170051249561,
     'indication': 0.9931026698937812,
     'them': 0.4576429863442768,
     'than': 0.39031302522043854,
     'cash': 0.9451015025480064,
     'spending': 0.9717760243462468,
     'dollar': 0.9664392672776755,
     'judging': 0.9789840649763263,
     'rash': 0.9955997535862008,
     'awful': 0.9230688533762283,
     'seeing': 0.8236964458451649,
     'avoid': 0.9456658028922511,
     'at': 0.241075097947889,
     'costs': 0.9844606606083962,
     'quest': 0.9582531673140451,
     'camelot': 0.9931026698937812,
     'warner': 0.9705849909916535,
     'bros': 0.9850729559279023,
     'feature': 0.8731957967163224,
     'length': 0.9417297927245484,
     'fully': 0.9394953197850304,
     'animated': 0.8984581522787353,
     'steal': 0.9576737492592907,
     'clout': 0.9943496440275739,
     'disney': 0.8452359351485201,
     'cartoon': 0.9473627543635081,
     'empire': 0.97476643566672,
     'mouse': 0.9688039050170661,
     'reason': 0.783751150523055,
     'worried': 0.9820190721841247,
     'other': 0.4484430123845496,
     'recent': 0.8824394646816951,
     'challenger': 0.9987388228172175,
     'throne': 0.9887627823350938,
     'last': 0.6526318391969739,
     'fall': 0.868884475702483,
     'promising': 0.9670293438839432,
     'flawed': 0.9699905684643744,
     '20th': 0.9826283331885693,
     'century': 0.9290247650778382,
     'fox': 0.934506319255142,
     'anastasia': 0.9862998343525426,
     'hercules': 0.9899988748734233,
     'lively': 0.980195813890161,
     'colorful': 0.9688039050170661,
     'palate': 0.9974808227632855,
     'had': 0.5060418810027413,
     'beat': 0.9570950314837867,
     'hands': 0.9145407721356723,
     'crown': 0.9906180808346156,
     '1997': 0.9339552546850491,
     'piece': 0.866507642984539,
     'animation': 0.9177202721025368,
     'year': 0.6412694042480829,
     'contest': 0.9850729559279023,
     'arrival': 0.977172048716082,
     'magic': 0.9451015025480064,
     'kingdom': 0.9881458928638276,
     'mediocre': 0.9553630671604879,
     '--': 0.4659911381008703,
     'd': 0.7242571405053915,
     'pocahontas': 0.9931026698937812,
     'those': 0.6094381296126704,
     'keeping': 0.9473627543635081,
     'score': 0.8819480794288961,
     'nearly': 0.8376365809542949,
     'dull': 0.9219941553829855,
     'revolves': 0.9682116614297417,
     'adventures': 0.9676201414938722,
     'free': 0.9087685475264227,
     'spirited': 0.9735680653053196,
     'kayley': 0.9974808227632855,
     'voiced': 0.9652612718031228,
     'jessalyn': 0.9993690135157306,
     'gilsig': 0.9993690135157306,
     'early': 0.8394123445797691,
     'daughter': 0.8332298692143391,
     'belated': 0.9987388228172175,
     'knight': 0.977172048716082,
     'king': 0.8608559532997793,
     'arthur': 0.9723726378605372,
     'round': 0.9699905684643744,
     'table': 0.9676201414938722,
     'dream': 0.906168827453628,
     'follow': 0.8954104996551373,
     'father': 0.7629852299332311,
     'footsteps': 0.9893804425232068,
     'she': 0.3352127700102861,
     'chance': 0.876578740549695,
     'evil': 0.7868661877366084,
     'warlord': 0.9981094263999697,
     'ruber': 0.9993690135157306,
     'gary': 0.9536373598583833,
     'oldman': 0.9795895647010799,
     'ex': 0.9056506673070984,
     'gone': 0.8903767666205686,
     'steals': 0.9640861445563118,
     'magical': 0.9688039050170661,
     'sword': 0.9729699843963092,
     'excalibur': 0.9981094263999697,
     'accidentally': 0.9652612718031228,
     'loses': 0.9490658069773853,
     'dangerous': 0.9513460914693481,
     'booby': 0.9974808227632855,
     'trapped': 0.9682116614297417,
     'forest': 0.9723726378605372,
     'help': 0.7467960505842081,
     'hunky': 0.9924803549272475,
     'blind': 0.9729699843963092,
     'timberland': 0.9987388228172175,
     'dweller': 0.9987388228172175,
     'garrett': 0.9943496440275739,
     'carey': 0.9918588194035645,
     'elwes': 0.9962259878476808,
     'headed': 0.954787137844974,
     'dragon': 0.9658499103560148,
     'eric': 0.9611608063987571,
     'idle': 0.9856860133680189,
     'rickles': 0.9974808227632855,
     'arguing': 0.9893804425232068,
     'itself': 0.7947631998875965,
     'able': 0.8236964458451649,
     'medieval': 0.9893804425232068,
     'sexist': 0.9912380618592832,
     'prove': 0.9394953197850304,
     'fighter': 0.980195813890161,
     'side': 0.8228405773007347,
     'pure': 0.9462307775029573,
     'showmanship': 0.9974808227632855,
     'essential': 0.9789840649763263,
     'element': 0.9134858289787868,
     'expected': 0.9198522493640451,
     'climb': 0.9899988748734233,
     'high': 0.7173682637171509,
     'ranks': 0.9850729559279023,
     'differentiates': 0.9987388228172175,
     'something': 0.5988384842824842,
     'saturday': 0.9676201414938722,
     'morning': 0.9599956358875514,
     'subpar': 0.9981094263999697,
     'instantly': 0.97476643566672,
     'forgettable': 0.9814105662341526,
     'songs': 0.930115925347365,
     'integrated': 0.9955997535862008,
     'computerized': 0.9974808227632855,
     'footage': 0.938382054958467,
     'compare': 0.97476643566672,
     'run': 0.8173204941635446,
     'angry': 0.9467964275893401,
     'ogre': 0.9875297726677557,
     'herc': 0.9987388228172175,
     'battle': 0.8731957967163224,
     'hydra': 0.9987388228172175,
     'rest': 0.7860851093397921,
     'case': 0.7904003353594634,
     'stink': 0.9968530104102417,
     'none': 0.8674568139247023,
     'remotely': 0.9693968735846054,
     'interesting': 0.7128480254926142,
     'race': 0.9257665914590665,
     'bland': 0.9496348526819441,
     'end': 0.5986121504864277,
     'tie': 0.9789840649763263,
     'win': 0.9339552546850491,
     'comedy': 0.6534396118523653,
     'shtick': 0.9912380618592832,
     'awfully': 0.9832383506537045,
     'cloying': 0.9968530104102417,
     'least': 0.7008611305325203,
     'signs': 0.9676201414938722,
     'pulse': 0.9856860133680189,
     'fans': 0.8660338360254153,
     "-'": 0.9981094263999697,
     '90s': 0.97476643566672,
     'tgif': 0.9987388228172175,
     'will': 0.41681448068592725,
     'thrilled': 0.9906180808346156,
     'jaleel': 0.9993690135157306,
     'urkel': 0.9987388228172175,
     'white': 0.8345470065654277,
     'bronson': 0.9875297726677557,
     'balki': 0.9993690135157306,
     'pinchot': 0.9987388228172175,
     'sharing': 0.9912380618592832,
     'nicely': 0.9417297927245484,
     'realized': 0.9473627543635081,
     'though': 0.6275487158355192,
     'm': 0.6853930639340148,
     'loss': 0.9670293438839432,
     'recall': 0.9682116614297417,
     'specific': 0.9777753083675964,
     'providing': 0.9717760243462468,
     'voice': 0.8520566811202805,
     'talent': 0.876578740549695,
     'enthusiastic': 0.9887627823350938,
     'paired': 0.9943496440275739,
     'singers': 0.9937257657702877,
     'sound': 0.8660338360254153,
     'musical': 0.9113832272617418,
     'moments': 0.7798918663397051,
     'jane': 0.9502045811785316,
     'seymour': 0.9949743061401415,
     'celine': 0.9937257657702877,
     'dion': 0.9987388228172175,
     'must': 0.7193231054309618,
     'strain': 0.9912380618592832,
     'through': 0.5709887447635391,
     'aside': 0.9306624672409537,
     'children': 0.8249835922117699,
     'probably': 0.7460924619138692,
     'adults': 0.9490658069773853,
     'grievous': 0.9981094263999697,
     'error': 0.9906180808346156,
     'lack': 0.8698388638086137,
     'personality': 0.9317574802037862,
     'learn': 0.9020400724447836,
     'goes': 0.710290516723323,
     'synopsis': 0.9594141093517162,
     'mentally': 0.977172048716082,
     'unstable': 0.9906180808346156,
     'undergoing': 0.9981094263999697,
     'psychotherapy': 0.9987388228172175,
     'saves': 0.9735680653053196,
     'boy': 0.8139601813117349,
     'potentially': 0.9759677598254889,
     'fatal': 0.9759677598254889,
     'falls': 0.868884475702483,
     'love': 0.5859879681221835,
     'mother': 0.783751150523055,
     'fledgling': 0.9955997535862008,
     'restauranteur': 0.9987388228172175,
     'unsuccessfully': 0.9943496440275739,
     'attempting': 0.9664392672776755,
     'gain': 0.9741668819426504,
     'woman': 0.7408575090512766,
     'favor': 0.9711801425049975,
     'takes': 0.7014819604751487,
     'pictures': 0.9312096518150069,
     'kills': 0.9530635086832508,
     'comments': 0.9676201414938722,
     'stalked': 0.9856860133680189,
     'yet': 0.722604958436368,
     'seemingly': 0.9273928165731752,
     'endless': 0.9652612718031228,
     'string': 0.9759677598254889,
     'spurned': 0.9974808227632855,
     'psychos': 0.9974808227632855,
     'getting': 0.7959614437486808,
     'revenge': 0.9406112292287774,
     'type': 0.8809669488602864,
     'stable': 0.9906180808346156,
     'category': 0.9753667278392926,
     '1990s': 0.9856860133680189,
     'industry': 0.9479297590404712,
     'theatrical': 0.9629138750744762,
     'direct': 0.9536373598583833,
     'proliferation': 0.9981094263999697,
     'may': 0.6488884882949173,
     'due': 0.88987650436561,
     'typically': 0.9826283331885693,
     'inexpensive': 0.9981094263999697,
     'produce': 0.9729699843963092,
     'special': 0.7339907869979888,
     'effects': 0.7093361757777161,
     'stars': 0.7987714467273883,
     'serve': 0.9524903477225436,
     'vehicles': 0.9844606606083962,
     'nudity': 0.9559396916985551,
     'allowing': 0.9741668819426504,
     'frequent': 0.9783793133269912,
     'night': 0.7845275953279639,
     'cable': 0.9699905684643744,
     'wavers': 0.9993690135157306,
     'slightly': 0.9129592695495786,
     'norm': 0.9838491259892411,
     'respect': 0.9451015025480064,
     'psycho': 0.9629138750744762,
     'never': 0.5354686897782827,
     'affair': 0.9428510197521164,
     ';': 0.4612414162652672,
     'contrary': 0.9832383506537045,
     'rejected': 0.9881458928638276,
     'rather': 0.7183443546411952,
     'lover': 0.9439749198364544,
     'wife': 0.7292593308837749,
     'husband': 0.8589884045080322,
     'entry': 0.9723726378605372,
     'doomed': 0.9820190721841247,
     'collect': 0.9881458928638276,
     'dust': 0.9869144203088196,
     'viewed': 0.9723726378605372,
     'midnight': 0.9693968735846054,
     'provide': 0.9263080324244657,
     'suspense': 0.8868866963075785,
     'sets': 0.8679321796122358,
     'interspersed': 0.9968530104102417,
     'opening': 0.8380798171254406,
     'credits': 0.8863903470970775,
     'instance': 0.954787137844974,
     'serious': 0.8799879987998799,
     'sounding': 0.9789840649763263,
     'narrator': 0.977172048716082,
     'spouts': 0.9974808227632855,
     'statistics': 0.9993690135157306,
     'stalkers': 0.9987388228172175,
     'ponders': 0.9955997535862008,
     'cause': 0.9417297927245484,
     'stalk': 0.9974808227632855,
     'implicitly': 0.9981094263999697,
     'implied': 0.9943496440275739,
     'men': 0.7485608416594984,
     'shown': 0.923607142440606,
     'snapshot': 0.9993690135157306,
     'actor': 0.7436403076316308,
     'jay': 0.9406112292287774,
     'underwood': 0.9931026698937812,
     'states': 0.9350580345018952,
     'daryl': 0.9850729559279023,
     'gleason': 0.9987388228172175,
     'stalker': 0.9937257657702877,
     'brooke': 0.9918588194035645,
     'daniels': 0.9832383506537045,
     'meant': 0.9456658028922511,
     'called': 0.8020072715487994,
     'guesswork': 0.9993690135157306,
     'required': 0.9676201414938722,
     'proceeds': 0.9820190721841247,
     'begins': 0.8016013604478142,
     'obvious': 0.8443347442718384,
     'sequence': 0.812290365264486,
     'contrived': 0.9536373598583833,
     'quite': 0.7058587587239619,
     'brings': 0.8868866963075785,
     'victim': 0.9334048396412112,
     'together': 0.752115565432943,
     'obsesses': 0.9974808227632855,
     'follows': 0.903068729972289,
     'tries': 0.810627386350841,
     'woo': 0.9439749198364544,
     'plans': 0.9462307775029573,
     'become': 0.7560649602352469,
     'desperate': 0.9400529433411284,
     'elaborate': 0.9617444529456772,
     'include': 0.9350580345018952,
     'cliche': 0.9605778678084933,
     'murdered': 0.9664392672776755,
     'pet': 0.9753667278392926,
     'require': 0.9777753083675964,
     'found': 0.799174496170187,
     'exception': 0.9394953197850304,
     'cat': 0.9640861445563118,
     'shower': 0.9808028139359185,
     'events': 0.8873836017077351,
     'lead': 0.8632018399625032,
     'inevitable': 0.9576737492592907,
     'showdown': 0.977172048716082,
     'survives': 0.9875297726677557,
     'invariably': 0.9962259878476808,
     'conclusion': 0.928480144446659,
     'turkey': 0.9753667278392926,
     'uniformly': 0.9906180808346156,
     'adequate': 0.9765695329937972,
     'anything': 0.7193231054309618,
     'home': 0.7422463000627981,
     'either': 0.8040430090058991,
     'turns': 0.7971633061877775,
     'toward': 0.9406112292287774,
     'melodrama': 0.9777753083675964,
     'overdoes': 0.9974808227632855,
     'words': 0.8804772017211283,
     'manages': 0.8646155189920408,
     'creepy': 0.9445378752638923,
     'pass': 0.9417297927245484,
     'demands': 0.9729699843963092,
     'maryam': 0.9993690135157306,
     'abo': 0.9981094263999697,
     'close': 0.8456872523787656,
     'played': 0.6669221246241821,
     'bond': 0.9108590883472699,
     'chick': 0.9795895647010799,
     'living': 0.8712743836023368,
     'daylights': 0.9993690135157306,
     'equally': 0.9350580345018952,
     'title': 0.8420901521676716,
     'ditzy': 0.9912380618592832,
     'strong': 0.8552775107731853,
     'independent': 0.9723726378605372,
     'business': 0.8913789804257044,
     'owner': 0.9411701786287304,
     'needs': 0.8775501158010217,
     'proceed': 0.9838491259892411,
     'example': 0.8407491161575946,
     'suspicions': 0.9968530104102417,
     'ensure': 0.9906180808346156,
     'use': 0.799174496170187,
     'excuse': 0.954787137844974,
     'decides': 0.8933901918976546,
     'return': 0.8903767666205686,
     'toolbox': 0.9987388228172175,
     'left': 0.7931711421159644,
     'place': 0.7203045269735585,
     ...}




```python
corpus_sif_weighting['the'] # low SIF weight for a common stopword
```




    0.020276057118408988




```python
corpus_sif_weighting['computer'] #high SIF for a word carrying meaning in a more specific context
```




    0.8529744401719068




```python
from collections import Counter
from nltk.tokenize import RegexpTokenizer
from nltk.corpus import stopwords
from nltk.tokenize import word_tokenize

text='''Note that if you use RegexpTokenizer option, you lose 
natural language features special to word_tokenize 
like splitting apart contractions. You can naively 
split on the regex \w+ without any need for the NLTK.
'''

# tokenize
raw = ' '.join(word_tokenize(text.lower()))

tokenizer = RegexpTokenizer(r'[A-Za-z]{2,}')
words = tokenizer.tokenize(raw)

# remove stopwords
stop_words = set(stopwords.words('english'))
words = [word for word in words if word not in stop_words]

# count word frequency, sort and return just 20
counter = Counter()
counter.update(words)
most_common = counter.most_common(20)
most_common
```




    [('note', 1),
     ('use', 1),
     ('regexptokenizer', 1),
     ('option', 1),
     ('lose', 1),
     ('natural', 1),
     ('language', 1),
     ('features', 1),
     ('special', 1),
     ('word', 1),
     ('tokenize', 1),
     ('like', 1),
     ('splitting', 1),
     ('apart', 1),
     ('contractions', 1),
     ('naively', 1),
     ('split', 1),
     ('regex', 1),
     ('without', 1),
     ('need', 1)]




```python
words
```




    ['note',
     'use',
     'regexptokenizer',
     'option',
     'lose',
     'natural',
     'language',
     'features',
     'special',
     'word',
     'tokenize',
     'like',
     'splitting',
     'apart',
     'contractions',
     'naively',
     'split',
     'regex',
     'without',
     'need',
     'nltk']



### Training Word2Vec embeddings on the corpus


```python
import gensim
```


```python
gensim.__version__
```




    '4.1.2'




```python
movie_reviews.sents()
```




    [['plot', ':', 'two', 'teen', 'couples', 'go', 'to', 'a', 'church', 'party', ',', 'drink', 'and', 'then', 'drive', '.'], ['they', 'get', 'into', 'an', 'accident', '.'], ...]




```python
w2v_model = gensim.models.Word2Vec(sentences=movie_reviews.sents(),
                                  vector_size=150,
                                  window=5,
                                  workers=4,
                                  min_count=0,
                                  epochs=8)
```


```python
w2v_model.wv['love'].shape
```




    (150,)



# Sentence Embeddings

## Approach 1 : Unweighted Sum of word embeddings


```python
import numpy as np
```


```python
def sent_emb_1(sentence:list):
    emb = w2v_model.wv[sentence]
    return np.mean(emb,axis=0)
```


```python
sent_emb_1(sentences[0][0])
```




    array([ 0.04841578, -0.23187251, -0.02132036,  0.40737662,  0.06070386,
            0.20279986, -0.00813549,  0.21838196, -0.41697463,  0.21819595,
            0.09217939,  0.40294555, -0.04848393,  0.59762585,  0.0021255 ,
            0.2399333 ,  0.63461375, -0.61282927,  0.10416698,  0.5019918 ,
           -0.07852356,  0.6542678 ,  0.31906894, -0.08222269,  0.3880289 ,
            0.16355842, -0.8003601 , -0.08823899,  0.6252954 , -0.16038217,
            0.35031775,  0.11183237, -0.27829462, -0.09100681,  0.02570677,
            0.42795777,  0.06055289,  0.5669999 , -0.22074568, -0.3855428 ,
           -0.12497441,  0.28189543, -0.2623843 , -0.29549196,  0.03417622,
            0.29309455, -0.48708475,  0.32358903, -0.16807798,  0.0562325 ,
           -0.22501743,  0.07685026, -0.39640513, -0.6732754 ,  0.03780558,
           -0.16952832, -0.04054368, -0.20196743, -0.11393835, -0.51330626,
           -0.3353771 , -0.5406283 ,  0.03023254, -0.19013628,  0.51542807,
            0.17119089, -0.27238953, -0.22630805,  0.30839062, -0.5411516 ,
            0.28102806,  0.5534792 , -0.32176632, -0.2341663 ,  0.08270159,
           -0.1947818 ,  0.47246078, -0.34120423, -0.33664817,  0.20775212,
            0.49063545, -0.29816365,  0.08717688,  0.33861184, -0.2514325 ,
            0.02714597,  0.18686284, -0.32275334, -0.32306457, -0.06328997,
            0.04393419,  0.10023954,  0.41592488, -0.39596754,  0.13303635,
           -0.23417407,  0.06101354, -0.33403295,  0.70954645,  0.35185376,
           -0.23478714, -0.04874816,  0.4507951 ,  0.11918066, -0.65959346,
           -0.18937033,  0.570614  ,  0.58561337, -0.66130996, -0.21029888,
            0.7080803 , -0.39580536,  0.4192149 , -0.21938518,  0.10856716,
           -0.20148921,  0.23107408, -0.40665972,  0.8267786 ,  0.1903063 ,
           -0.02162168,  0.09171966,  0.34488347, -0.24665132, -0.1793515 ,
            0.240216  ,  0.477285  ,  0.0987767 , -0.13671671,  0.08955551,
            0.21159546, -0.02021011,  0.0200981 , -0.03197998,  0.30332035,
           -0.30240628, -0.34636158,  0.25459823,  0.45058823,  0.09923147,
            0.08138961,  0.31858924, -0.19485438,  0.32011455, -0.06799296,
            0.62635386, -0.21813577,  0.13166988,  0.0549    , -0.39542368],
          dtype=float32)



## Approach 2 : SIF Weighted Sum of word embeddings


```python
def sent_emb_2(sentence:list,emb_dim : int):
    n=len(sentence)
    emb = np.zeros(emb_dim)
    for word in sentence:
        emb+= w2v_model.wv[word] * corpus_sif_weighting[word]
    return emb/n
```


```python
sent_emb_2(sentences[0][0],150)
```




    array([-0.11116752, -0.13005966,  0.04650587,  0.21323752, -0.00276145,
            0.14860074, -0.0262641 ,  0.10307227, -0.17657994,  0.20726014,
            0.05644629,  0.26154762, -0.04759888,  0.28380906, -0.00648723,
            0.16147982,  0.18875704, -0.3250262 ,  0.01452463,  0.18531756,
            0.01456033,  0.16492823,  0.28582147, -0.03731463,  0.12768277,
           -0.03805458, -0.23749751, -0.11485145,  0.22288583, -0.15585675,
            0.14707802,  0.03415579, -0.14801836, -0.01798894,  0.09993909,
            0.08985393,  0.02311353,  0.23461261, -0.04593433, -0.24576969,
            0.00184033,  0.10539486, -0.01499137, -0.13208754,  0.06274415,
            0.1838043 , -0.25663814,  0.00054816, -0.10715505, -0.02699988,
           -0.02646498,  0.05996319, -0.13035522, -0.31924159,  0.00091247,
           -0.09107593, -0.0335299 , -0.04674318, -0.03349305, -0.18617075,
           -0.08737971, -0.27196264, -0.03222106,  0.00761876,  0.21628145,
            0.09080885,  0.00533347, -0.14849763,  0.13214848, -0.21092669,
            0.16018401,  0.13290027, -0.16408405, -0.12323369,  0.03930859,
           -0.00304261,  0.2666555 , -0.01438416, -0.16452444,  0.11749264,
            0.21614496, -0.11921996, -0.06783965,  0.17993575, -0.15093858,
            0.11098862,  0.10411914, -0.18390186, -0.15214851, -0.16909018,
            0.07305404,  0.02383218,  0.27614804, -0.240414  ,  0.18440486,
           -0.06680337,  0.07105514, -0.12729477,  0.21475473,  0.17657499,
           -0.08373448,  0.0437017 ,  0.00859422, -0.00324362, -0.21772201,
           -0.15208305,  0.30155103,  0.31910857, -0.28276755, -0.12612618,
            0.16875719, -0.18336622,  0.1825903 , -0.04732556,  0.0516821 ,
           -0.06989783,  0.13177907, -0.13635651,  0.31569131,  0.16623097,
           -0.00608667,  0.02001035,  0.08745232, -0.10265362, -0.08167814,
            0.14704094,  0.19206184,  0.00609933, -0.08545212,  0.03292659,
            0.10337701,  0.09683871, -0.04804365, -0.09427614,  0.11987261,
           -0.07734111, -0.13296911,  0.08462291,  0.05851839, -0.00743771,
            0.08316949,  0.09765119,  0.06856632,  0.08056945,  0.09283326,
            0.25650697,  0.01910476, -0.00614543,  0.04118317, -0.12819755])



## Approach 3 : Embeddings with BERT transformers





```python
pip install -U sentence-transformers
```

    Collecting sentence-transformers
      Downloading sentence-transformers-2.1.0.tar.gz (78 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 78 kB 3.4 MB/s 
    [?25hCollecting transformers<5.0.0,>=4.6.0
      Downloading transformers-4.12.3-py3-none-any.whl (3.1 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3.1 MB 11.2 MB/s 
    [?25hCollecting tokenizers>=0.10.3
      Downloading tokenizers-0.10.3-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (3.3 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3.3 MB 47.2 MB/s 
    [?25hRequirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from sentence-transformers) (4.62.3)
    Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.7/dist-packages (from sentence-transformers) (1.9.0+cu111)
    Requirement already satisfied: torchvision in /usr/local/lib/python3.7/dist-packages (from sentence-transformers) (0.10.0+cu111)
    Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from sentence-transformers) (1.19.5)
    Requirement already satisfied: scikit-learn in /usr/local/lib/python3.7/dist-packages (from sentence-transformers) (0.22.2.post1)
    Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from sentence-transformers) (1.4.1)
    Requirement already satisfied: nltk in /usr/local/lib/python3.7/dist-packages (from sentence-transformers) (3.2.5)
    Collecting sentencepiece
      Downloading sentencepiece-0.1.96-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.2 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1.2 MB 57.7 MB/s 
    [?25hCollecting huggingface-hub
      Downloading huggingface_hub-0.1.2-py3-none-any.whl (59 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 59 kB 6.3 MB/s 
    [?25hRequirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch>=1.6.0->sentence-transformers) (3.10.0.2)
    Collecting pyyaml>=5.1
      Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 596 kB 60.1 MB/s 
    [?25hRequirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers<5.0.0,>=4.6.0->sentence-transformers) (3.3.2)
    Collecting sacremoses
      Downloading sacremoses-0.0.46-py3-none-any.whl (895 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 895 kB 76.2 MB/s 
    [?25hRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers<5.0.0,>=4.6.0->sentence-transformers) (4.8.1)
    Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers<5.0.0,>=4.6.0->sentence-transformers) (2019.12.20)
    Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers<5.0.0,>=4.6.0->sentence-transformers) (21.2)
    Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers<5.0.0,>=4.6.0->sentence-transformers) (2.23.0)
    Requirement already satisfied: pyparsing<3,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers<5.0.0,>=4.6.0->sentence-transformers) (2.4.7)
    Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers<5.0.0,>=4.6.0->sentence-transformers) (3.6.0)
    Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from nltk->sentence-transformers) (1.15.0)
    Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers<5.0.0,>=4.6.0->sentence-transformers) (1.24.3)
    Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers<5.0.0,>=4.6.0->sentence-transformers) (2.10)
    Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers<5.0.0,>=4.6.0->sentence-transformers) (2021.10.8)
    Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers<5.0.0,>=4.6.0->sentence-transformers) (3.0.4)
    Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers<5.0.0,>=4.6.0->sentence-transformers) (7.1.2)
    Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers<5.0.0,>=4.6.0->sentence-transformers) (1.1.0)
    Requirement already satisfied: pillow>=5.3.0 in /usr/local/lib/python3.7/dist-packages (from torchvision->sentence-transformers) (7.1.2)
    Building wheels for collected packages: sentence-transformers
      Building wheel for sentence-transformers (setup.py) ... [?25l[?25hdone
      Created wheel for sentence-transformers: filename=sentence_transformers-2.1.0-py3-none-any.whl size=121000 sha256=802a9aeff1041159cea65f80c5cab7e73e90258c138f14f7e1db125c2133080c
      Stored in directory: /root/.cache/pip/wheels/90/f0/bb/ed1add84da70092ea526466eadc2bfb197c4bcb8d4fa5f7bad
    Successfully built sentence-transformers
    Installing collected packages: pyyaml, tokenizers, sacremoses, huggingface-hub, transformers, sentencepiece, sentence-transformers
      Attempting uninstall: pyyaml
        Found existing installation: PyYAML 3.13
        Uninstalling PyYAML-3.13:
          Successfully uninstalled PyYAML-3.13
    Successfully installed huggingface-hub-0.1.2 pyyaml-6.0 sacremoses-0.0.46 sentence-transformers-2.1.0 sentencepiece-0.1.96 tokenizers-0.10.3 transformers-4.12.3



```python
from sentence_transformers import SentenceTransformer
# model = SentenceTransformer('all-MiniLM-L6-v2')
model = SentenceTransformer('bert-base-nli-mean-tokens')
```


    Downloading:   0%|          | 0.00/391 [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/3.95k [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/2.00 [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/625 [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/122 [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/229 [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/438M [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/53.0 [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/112 [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/466k [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/399 [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/232k [00:00<?, ?B/s]



    Downloading:   0%|          | 0.00/190 [00:00<?, ?B/s]



```python
def sent_emb_3(sentence:list):
    emb = model.encode(sentence)
    return(emb)
```


```python
sent_emb_3(sentences[0][0])
```




    array([[-0.31022093, -0.8895407 ,  2.4462802 , ..., -0.47177592,
            -0.23932761,  0.39813098],
           [-0.0190731 , -0.2524138 ,  2.4880831 , ...,  0.24632902,
             0.21949482,  0.3175112 ],
           [ 0.12544073, -0.38628218,  1.7481121 , ...,  0.44302788,
             0.45639274, -0.16370691],
           ...,
           [-0.14682347, -0.44106725,  2.4785135 , ...,  0.12852906,
            -0.12413316, -0.0459558 ],
           [-0.1805218 ,  0.05617952,  2.3374186 , ..., -0.6111302 ,
            -0.22054918,  0.01559925],
           [ 0.04505367, -0.13585904,  2.5101764 , ...,  0.4691844 ,
             0.19670881,  0.08466091]], dtype=float32)



# Confronting the 3 approach with a sentiment analysis task on IMBD dataset


```python
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
```


```python
X_train, X_test, y_train, y_test = train_test_split([sentence[0] for sentence in sentences], [sentence[1] for sentence in sentences], test_size = 0.2, random_state=0)
```


```python
y_train, y_test = [1 if y == 'pos' else 0 for y in y_train], [1 if y == 'pos' else 0 for y in y_test]
```

## Approach 1 : Unweighted Sum of word embeddings :


```python
X_train_1 , X_test_1 = [], []

for i in range(len(X_train)): 
  X_train_1.append(sent_emb_1(X_train[i]))

for i in range(len(X_test)):
  X_test_1.append(sent_emb_1(X_test[i]))
```


```python
clf = LogisticRegression(solver='sag', random_state=0)
clf.fit(X_train_1, y_train)
clf.score(X_test_1, y_test)
```




    0.5125



## Approach 2 : SIF Weighted Sum of word embeddings


```python
X_train_2 , X_test_2 = [], []

for i in range(len(X_train)): 
  X_train_2.append(sent_emb_2(X_train[i], 150))

for i in range(len(X_test)):
  X_test_2.append(sent_emb_2(X_test[i], 150))
```


```python
clf = LogisticRegression(solver='sag', random_state=0)
clf.fit(X_train_2, y_train)
clf.score(X_test_2, y_test)
```




    0.535



## Approach 3 : Embeddings with BERT transformers


```python
X_train_3, X_test_3 = sent_emb_3(X_train), sent_emb_3(X_test)
```


```python
from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
X_train_3 = scaler.fit_transform(X_train_3)
X_test_3 = scaler.transform(X_test_3)
```


```python
clf = LogisticRegression(solver='sag', random_state=0)
clf.fit(X_train_3, y_train)
clf.score(X_test_3, y_test)
```

    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
      "the coef_ did not converge", ConvergenceWarning)





    0.56



# Conclusion

As expected, the SIF weighted sum of word embeddings outperforms the unweighted sum.
Also, the embeddings with bert outperfom both the SIF weighted and unweighted sum. 
It seems logical as the BERT model is the last model available between the three we have tested.

We can note that the accuracy obtained are not very high. This is totally normal as we have used a very simple model for such a complicated task.
